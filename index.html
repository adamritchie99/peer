<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Peer Auto</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,800;0,900;1,800;1,900&display=swap" rel="stylesheet">
  <style>
    /* CSS Variables for easier maintenance (Heirloom Principle: Centralized Control) */
    :root {
      --brand-red: #ED1C24;
      --bg-dark: #0f0f0f;
      --border-color: #333;
      --text-gray: #aaa;
    }

    body, html {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg-dark);
      color: white;
      display: flex;
      flex-direction: column;
      /* Shorthand background for cleanliness */
      background: linear-gradient(rgba(15, 15, 15, 0.88), rgba(15, 15, 15, 0.94)),
                  url('https://images.unsplash.com/photo-1617788810580-8e0a3c3b3b2e?auto=format&fit=crop&q=80&w=2000') center/cover no-repeat fixed;
    }

    main { flex: 1; }

    .top-bar {
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.8rem 1.5rem;
      background: rgba(15, 15, 15, 0.92);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid #222;
      transition: padding 0.3s ease, box-shadow 0.3s ease;
    }

    .top-bar.scrolled {
      padding: 0.6rem 1.5rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.6);
    }

    .logo a {
      background: var(--brand-red);
      color: white;
      font-family: 'Montserrat', sans-serif;
      font-weight: 900;
      font-style: italic;
      font-size: clamp(1.3rem, 4vw, 1.9rem);
      padding: 0.45rem 1rem;
      border-radius: 8px;
      text-decoration: none;
      letter-spacing: -0.04em;
      display: inline-block;
      transition: transform 0.2s ease;
    }

    .logo a:hover { transform: scale(1.05); }

    .nav-pill {
      background: #1a1a1a;
      border: 1px solid #444;
      border-radius: 50px;
      padding: 0.4rem;
      display: flex;
      gap: 0.5rem;
    }

    .nav-pill a {
      color: #ddd;
      text-decoration: none;
      font-weight: 600;
      padding: 0.6rem 1.2rem;
      border-radius: 40px;
      transition: 0.2s ease;
      font-size: clamp(0.95rem, 2.5vw, 1.05rem);
    }

    .nav-pill a:hover {
      background: var(--brand-red);
      color: white;
    }

    .hero {
      min-height: 85vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 6rem 1.5rem 4rem;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.8s ease-out, transform 0.8s ease-out;
    }

    .hero.visible { opacity: 1; transform: translateY(0); }

    h1 { font-size: clamp(2.2rem, 8vw, 4.5rem); margin-bottom: 1.5rem; }

    .selector-container {
      background: #111;
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }

    .dropdown-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.2rem;
      margin-bottom: 1.5rem;
    }

    .status-msg { font-size: 0.85rem; color: var(--text-gray); margin-top: 0.4rem; min-height: 1.2em; }

    button, select {
      width: 100%;
      padding: 1rem;
      font-size: 1.1rem;
      background: #1a1a1a;
      color: white;
      border: 1px solid #444;
      border-radius: 12px;
      cursor: pointer;
      transition: 0.2s;
    }

    button:disabled { opacity: 0.4; cursor: not-allowed; }
    button:not(:disabled):hover { background: #252525; border-color: #777; }

    .vehicle-btn { background: var(--brand-red); border: none; font-weight: 700; }
    .vehicle-btn:not(:disabled):hover { background: #ff2a33; }

    .clear-btn { background: transparent; border: 1px solid #444; color: var(--text-gray); }

    .or-divider {
      display: flex;
      align-items: center;
      margin: 2rem 0;
      color: #555;
    }
    .or-divider::before, .or-divider::after { content: ''; flex: 1; height: 1px; background: #333; margin: 0 1rem; }

    footer { padding: 3rem 1rem; font-size: 0.85rem; color: #555; text-align: center; }

    @media (max-width: 700px) {
      .top-bar { flex-direction: column; gap: 1rem; }
      .hero { padding-top: 3rem; }
    }
  </style>
</head>
<body>

  <header class="top-bar" id="topBar">
    <div class="logo">
      <a href="#" id="logoLink">Peer Auto</a>
    </div>
    <nav class="nav-pill">
      <a href="#" data-label="Buy">Buy</a>
      <a href="#" data-label="Sell">Sell</a>
      <a href="#" data-label="Account">Account</a>
    </nav>
  </header>

  <main>
    <section class="hero" id="hero">
      <h1>Zero fees to buy or sell any automotive products</h1>
      
      <div class="selector-container">
        <h2>What vehicle are you shopping for?</h2>
        <div class="dropdown-container">
          <div>
            <select id="year"><option value="" disabled selected>Select Year</option></select>
            <div class="status-msg" id="make-status"></div>
          </div>
          <div>
            <select id="make" disabled><option value="" disabled selected>Select Make</option></select>
            <div class="status-msg" id="model-status"></div>
          </div>
          <div>
            <select id="model" disabled><option value="" disabled selected>Select Model</option></select>
          </div>
        </div>

        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
          <button id="search-btn" class="vehicle-btn" disabled>Search Vehicle Parts</button>
          <button id="clear-btn" class="clear-btn">Clear</button>
        </div>

        <div class="or-divider">OR</div>
        <button id="generic-btn" class="clear-btn" style="width: auto; padding: 1rem 2rem;">Generic Automotive Goods</button>
      </div>
    </section>
  </main>

  <footer>
    Designed by humans in Detroit, Michigan.
  </footer>

  <script>
    /** * Heirloom Logic: Native JavaScript (ES6+)
     * No dependencies, faster execution, future-proof.
     */
    document.addEventListener('DOMContentLoaded', () => {
      const elements = {
        hero: document.getElementById('hero'),
        topBar: document.getElementById('topBar'),
        year: document.getElementById('year'),
        make: document.getElementById('make'),
        model: document.getElementById('model'),
        searchBtn: document.getElementById('search-btn'),
        clearBtn: document.getElementById('clear-btn'),
        makeStatus: document.getElementById('make-status'),
        modelStatus: document.getElementById('model-status')
      };

      const API_BASE = 'https://www.carqueryapi.com/api/0.3/';

      // 1. Initial State
      setTimeout(() => elements.hero.classList.add('visible'), 100);

      // 2. Scroll Effect
      window.addEventListener('scroll', () => {
        elements.topBar.classList.toggle('scrolled', window.scrollY > 50);
      });

      // 3. Populate Years
      const currentYear = new Date().getFullYear();
      for (let y = currentYear + 1; y >= 1900; y--) {
        const opt = new Option(y, y);
        elements.year.add(opt);
      }

      // 4. API Fetching Logic
      const fetchData = async (params) => {
        // CarQuery requires JSONP-style callbacks for cross-domain. 
        // For a true "Heirloom" app, you'd eventually want a server-side proxy 
        // to avoid relying on global callback functions.
        const queryString = new URLSearchParams({ ...params, callback: 'callbackFunc' }).toString();
        return new Promise((resolve) => {
          window.callbackFunc = (data) => resolve(data);
          const script = document.createElement('script');
          script.src = `${API_BASE}?${queryString}`;
          document.head.appendChild(script);
          script.remove();
        });
      };

      // 5. Event Handlers
      elements.year.addEventListener('change', async () => {
        const year = elements.year.value;
        resetDropdowns(['make', 'model']);
        elements.makeStatus.textContent = 'Loading makes...';

        const data = await fetchData({ cmd: 'getMakes', year, sold_in_us: 1 });
        elements.makeStatus.textContent = '';
        
        if (data.Makes) {
          data.Makes.forEach(m => elements.make.add(new Option(m.make_display, m.make_id)));
          elements.make.disabled = false;
        }
      });

      elements.make.addEventListener('change', async () => {
        const year = elements.year.value;
        const make = elements.make.value;
        resetDropdowns(['model']);
        elements.modelStatus.textContent = 'Loading models...';

        const data = await fetchData({ cmd: 'getModels', make, year, sold_in_us: 1 });
        elements.modelStatus.textContent = '';

        if (data.Models) {
          data.Models.forEach(m => elements.model.add(new Option(m.model_name, m.model_name)));
          elements.model.disabled = false;
        }
      });

      elements.model.addEventListener('change', () => {
        elements.searchBtn.disabled = !elements.model.value;
      });

      elements.clearBtn.addEventListener('click', () => {
        elements.year.value = '';
        resetDropdowns(['make', 'model']);
        elements.searchBtn.disabled = true;
      });

      function resetDropdowns(ids) {
        ids.forEach(id => {
          elements[id].innerHTML = `<option value="" disabled selected>Select ${id.charAt(0).toUpperCase() + id.slice(1)}</option>`;
          elements[id].disabled = true;
          if (elements[`${id}Status`]) elements[`${id}Status`].textContent = '';
        });
      }

      // Generic Button Helper
      document.getElementById('generic-btn').onclick = () => alert('Universal items loading...');
      document.getElementById('logoLink').onclick = (e) => {
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
    });
  </script>
</body>
</html>
